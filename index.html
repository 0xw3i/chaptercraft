<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>ChapterCraft</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- Sticky Header -->
  <header class="topbar">
    <div class="brand">ChapterCraft</div>

    <div class="header-progress">
      <div class="progress-row">
        <div class="progress-bar">
          <div id="progressFillTop"></div>
        </div>
        <div id="progressTextTop" class="progress-text">0 / 0</div>
      </div>
    </div>

    <div class="top-actions">
      <button id="modeToggle" class="btn">Mobile: Auto</button>
      <button id="themeToggle" class="btn" title="Theme">üåô</button>
      <button id="btnTools" class="btn" aria-expanded="false">Tools ‚ñæ</button>

      <div id="toolsMenu" class="menu-pop" aria-hidden="true">
        <button class="menu-item" id="btnGlossary">Glossary</button>
        <button class="menu-item" id="btnBackups">Backups</button>
        <button class="menu-item" id="btnCheck">Check</button>
        <div class="menu-sep"></div>
        <button class="menu-item" id="btnExportProject">Export Project JSON</button>
        <button class="menu-item" id="btnImportProject">Import Project JSON</button>
      </div>
    </div>
  </header>

  <!-- SETUP (shared) -->
  <section class="panel" id="setupPanel">
    <div class="panel-head">
      <div class="panel-title">Setup</div>
      <div class="panel-tools">
        <label class="btn" for="fileInput">Upload .txt</label>
        <input id="fileInput" type="file" accept=".txt,text/plain" hidden />
        <button id="btnSplit" class="btn primary">Split & Start</button>
        <button id="btnClearAll" class="btn danger">Clear All</button>
      </div>
    </div>

    <div class="setup-grid">
      <div class="field">
        <label>Project Name (required for export)</label>
        <input id="projectName" class="input" placeholder="e.g. MartialGod" />
      </div>
      <div class="field">
        <label>Chapter Name (required for export)</label>
        <input id="chapterName" class="input" placeholder="e.g. Chapter 012" />
      </div>
    </div>

    <textarea id="rawText" class="textarea" placeholder="Paste chapter text here... Paragraphs should be separated by blank lines."></textarea>

    <div class="meta">
      <label class="chk"><input type="checkbox" id="toggleAutoAdvance" checked> Auto-advance</label>
      <label class="chk"><input type="checkbox" id="toggleDialogueTools" checked> Highlight dialogue</label>
      <label class="chk"><input type="checkbox" id="toggleAutoBackup" checked> Auto backups</label>
      <span class="hint">Tip: On mobile, use Focus flow automatically.</span>
    </div>
  </section>

  <!-- DESKTOP WORKSPACE -->
  <section id="desktopScreen" class="screen">
    <div class="toolbar">
      <input id="searchBox" class="input" placeholder="Search original/translation..." />
      <select id="filterMode" class="input">
        <option value="untranslated">Untranslated</option>
        <option value="done">Done</option>
        <option value="skipped">Skipped</option>
        <option value="dialogue">Dialogue</option>
        <option value="all">All</option>
      </select>

      <button id="btnPrev" class="btn">Prev</button>
      <button id="btnNext" class="btn">Next</button>
      <button id="btnFocus" class="btn">Focus</button>

      <button id="btnExportTxt" class="btn primary">Export .txt</button>
      <button id="btnExportReview" class="btn">Export Review</button>
    </div>

    <div id="paragraphs" class="cards"></div>
  </section>

  <!-- MOBILE TRANSLATION FLOW -->
  <section id="mobileScreen" class="screen">
    <div class="mobile-wrap">
      <div class="mobile-original" id="mOriginal"></div>
      <textarea id="mTranslation" class="mobile-translation" placeholder="Translate here..."></textarea>

      <div class="mobile-nav">
        <button id="mPrev" class="btn">‚Üê Prev</button>
        <button id="mSkip" class="btn danger">Skip</button>
        <button id="mDone" class="btn primary">Done</button>
        <button id="mNext" class="btn">Next ‚Üí</button>
      </div>

      <div class="mobile-mini">
        <button id="mExport" class="btn">Export</button>
        <button id="mGoSetup" class="btn">Setup</button>
      </div>
    </div>
  </section>

  <!-- Back to Top -->
  <button id="backToTop" class="back-to-top" aria-hidden="true" title="Back to top">‚Üë</button>

  <!-- Drawers -->
  <div class="drawer" id="drawerGlossary" aria-hidden="true">
    <div class="drawer-card">
      <div class="drawer-head">
        <div>
          <div class="drawer-title">Glossary</div>
          <div class="drawer-sub">Store names/terms for consistency.</div>
        </div>
        <button class="btn" id="btnCloseGlossary">‚úï</button>
      </div>
      <div class="drawer-body">
        <div class="row">
          <input id="glossKey" class="input grow" placeholder="Original term" />
          <input id="glossVal" class="input grow" placeholder="Your translation" />
          <button id="btnAddGloss" class="btn primary">Add</button>
        </div>
        <div class="row">
          <input id="glossSearch" class="input grow" placeholder="Search glossary..." />
          <button id="btnExportGlossary" class="btn">Export</button>
          <button id="btnImportGlossary" class="btn">Import</button>
          <button id="btnClearGlossary" class="btn danger">Clear</button>
          <input id="hiddenGlossaryImport" type="file" accept="application/json" hidden />
        </div>
        <div id="glossList" class="list"></div>
      </div>
    </div>
  </div>

  <div class="drawer" id="drawerBackups" aria-hidden="true">
    <div class="drawer-card">
      <div class="drawer-head">
        <div>
          <div class="drawer-title">Backups</div>
          <div class="drawer-sub">Snapshots stored locally. Export project often.</div>
        </div>
        <button class="btn" id="btnCloseBackups">‚úï</button>
      </div>
      <div class="drawer-body">
        <div class="row">
          <button id="btnMakeBackup" class="btn primary">Make Snapshot</button>
          <button id="btnDownloadProjectJson" class="btn">Download Project JSON</button>
        </div>
        <div id="backupList" class="list"></div>
      </div>
    </div>
  </div>

  <div class="drawer" id="drawerCheck" aria-hidden="true">
    <div class="drawer-card">
      <div class="drawer-head">
        <div>
          <div class="drawer-title">Check</div>
          <div class="drawer-sub">Quick consistency overview.</div>
        </div>
        <button class="btn" id="btnCloseCheck">‚úï</button>
      </div>
      <div class="drawer-body">
        <div id="checkReport" class="list"></div>
      </div>
    </div>
  </div>

  <input id="hiddenProjectImport" type="file" accept="application/json" hidden />

  <script src="script.js"></script>
</body>
</html>
